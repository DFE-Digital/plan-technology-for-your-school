@inject GovUk.Frontend.AspNetCore.PageTemplateHelper PageTemplateHelper
@inject Dfe.PlanTech.Web.Helpers.GtmConfiguration GtmConfiguration
@using Dfe.PlanTech.Web.Helpers;

@using System.Globalization;

@section Head {
    <link rel="stylesheet" as="style" href="~/css/application.css">

        @Html.Raw(GtmConfiguration.Analytics)
        <script nonce="@Context.Items["nonce"]">@GtmConfiguration.Head</script>
        @RenderSection("Head", false)
}

@{
    Layout = "_GovUkPageTemplate";

    if (ViewData["Title"] == null)
    {
        var routeData = Context.GetRouteData();
        ViewData["Title"] = routeData.GetTitleForPage();
    }
}

@section Header {
    @Html.Raw(GtmConfiguration.Body)

    <partial name="_CookieBanner" />
    <partial name="_Header" />

    @RenderSection("Header", false)
}

@section BeforeContent {
    <script 
        nonce="@Context.Items["nonce"]"
        defer>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>
    <partial name="BetaHeader" />

    @RenderSection("BeforeContent", required: false)
}

@RenderBody()

@section Footer {
    <partial name="_Footer" />
}

@section BodyEnd {
    <script async src="~/js/app.js" nonce="@Context.Items["nonce"]"></script>
    <script defer type="module" nonce="@Context.Items["nonce"]">
        import * as govuk from '/js/govuk-frontend.min.js';
        govuk.initAll();
    </script>

    @RenderSection("BodyEnd", required: false)
}