@model Dfe.PlanTech.Web.Models.QuestionViewModel
@using System.Text.Json;

@section BeforeContent {
    @{
        await Html.RenderPartialAsync("BackButton");
    }
}

<form asp-controller="Questions"
    asp-action="SubmitAnswer"
    asp-route-sectionSlug=@Model.SectionSlug
    asp-route-questionSlug=@Model.Question.Slug
    method="post">

    <input id="QuestionId" hidden value=@Model.Question.Sys.Id name="QuestionId" />
    <input id="Params" hidden value="@Model.Params" name="Params" />
    <input id="SubmissionId" hidden value="@Model.SubmissionId" name="SubmissionId" />

    <govuk-radios name="ChosenAnswerJson">
        <govuk-radios-fieldset>
            <govuk-radios-fieldset-legend is-page-heading="true" class="govuk-fieldset__legend--l">
                @Model.Question.Text
            </govuk-radios-fieldset-legend>

            @if (!string.IsNullOrEmpty(Model.Question.HelpText))
            {
                <govuk-radios-hint>@Model.Question.HelpText</govuk-radios-hint>
            }

            @if (!string.IsNullOrEmpty(Model.QuestionErrorMessage))
            {
                <govuk-radios-error-message>@Model.QuestionErrorMessage</govuk-radios-error-message>
            }

            @{
                foreach (var answer in Model.Question.Answers)
                {
                    var answerDto = answer.AsDto;
                //var checked = false;//Model.AnswerRef != null && Model.AnswerRef.Equals(chosenAnswerId);
                    <govuk-radios-item value="@JsonSerializer.Serialize(answerDto)" checked="false">@answer.Text</govuk-radios-item>
                }
            }

        </govuk-radios-fieldset>
    </govuk-radios>

    <govuk-button type="submit">Save and continue</govuk-button>
</form>